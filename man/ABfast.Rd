% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ABfast.R
\name{ABfast}
\alias{ABfast}
\title{Adaptive bootstrap inference for mediation effects}
\usage{
ABfast(sp, N.boot = 1e+06, lambda = 1, lambda.n = NULL, test = "poc")
}
\arguments{
\item{sp}{A \code{data.table} returned by \code{SPsingle()}, containing
parameter estimates, standard errors, and covariance components.}

\item{N.boot}{Number of bootstrap replicates. Default is \code{1e6}.}

\item{lambda}{Tuning parameter controlling the adaptive truncation region.
Default is \code{1}.}

\item{lambda.n}{Optional numeric value specifying the truncation threshold.
If \code{NULL}, it is computed as
\eqn{\lambda \sqrt{n} / \log(n)}.}

\item{test}{Character string specifying the test statistic.
Options include \code{"poc"} (product-of-coefficients)
and \code{"maxp"} (minimum absolute t-statistic).}
}
\value{
A named numeric vector containing:
\itemize{
  \item \code{AB.pval}: adaptive bootstrap p-value,
  \item \code{B.pval}: standard bootstrap p-value,
  \item \code{rej.prop}: proportion of truncated bootstrap samples,
  \item \code{lambda.n}: truncation threshold used.
}
}
\description{
Performs adaptive bootstrap inference for mediation effects based on
semiparametric estimates obtained from \code{SPsingle()}.
}
\details{
The method implements an adaptive bootstrap procedure designed to improve
finite-sample inference when mediation effects are weak or partially
unidentified.


The adaptive bootstrap modifies the standard parametric bootstrap by
truncating extreme realizations of weakly identified parameters. When
the parameter estimates fall within a neighborhood of zero, inference
is adjusted using an alternative resampling scheme to stabilize test
statistics.

Two test statistics are supported:
\itemize{
  \item \code{"poc"}: product-of-coefficients statistic,
  \item \code{"maxp"}: minimum absolute t-statistic.
}
}
\references{
He, Y., Song, P. X.-K., and Xu, G. (2024).
Adaptive bootstrap tests for composite null hypotheses in the mediation
pathway analysis.
\emph{Journal of the Royal Statistical Society: Series B (Statistical Methodology)},
86(2), 411--434.
}
